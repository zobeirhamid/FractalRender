(this.webpackJsonpfractalrender=this.webpackJsonpfractalrender||[]).push([[0],{124:function(t,e,n){t.exports=n(157)},156:function(t,e,n){},157:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),i=n(12),r=n.n(i),l=n(39),c=n(40),u=n(41),s=n(42);var m=function(t,e,n){var o=r(t,t.VERTEX_SHADER,e),a=r(t,t.FRAGMENT_SHADER,n),i=t.createProgram();return null!==i&&null!==o&&null!==a?(t.attachShader(i,o),t.attachShader(i,a),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?(t.validateProgram(i),t.getProgramParameter(i,t.VALIDATE_STATUS)?i:(console.error("Error validating the program: "+t.getProgramInfoLog(i)),null)):(console.error("Error linking the program: "+t.getProgramInfoLog(i)),null)):null;function r(t,e,n){var o=t.createShader(e);return null!==o?(t.shaderSource(o,n),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(console.error("Error compiling the shader: "+t.getShaderInfoLog(o)),t.deleteShader(o),null)):null}};function d(t){return Math.abs(t.boundaries[0]-t.boundaries[1])}function f(t){return Math.abs(t.boundaries[2]-t.boundaries[3])}function g(t,e){return p(t,window.innerWidth/2,window.innerHeight/2,e)}function p(t,e,n,o){var a=o<0?.05:-.05,i=e/t.width,r=n/t.height;return{boundaries:[t.boundaries[0]+i*d(t)*a,t.boundaries[1]-(1-i)*d(t)*a,t.boundaries[2]+(1-r)*f(t)*a,t.boundaries[3]-r*f(t)*a]}}var h=function(t,e,n){t.vertexAttribPointer(0,3,t.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),t.enableVertexAttribArray(0),t.uniform1f(t.getUniformLocation(e,"iterations"),n.iterations),t.uniform1f(t.getUniformLocation(e,"radius"),n.radius),t.uniform1i(t.getUniformLocation(e,"mode"),n.mode),t.uniform1i(t.getUniformLocation(e,"smooth"),n.smooth),t.uniform1i(t.getUniformLocation(e,"interpolation"),n.interpolation),t.uniform1i(t.getUniformLocation(e,"samplingRate"),n.samplingRate),t.uniform1f(t.getUniformLocation(e,"width"),n.width),t.uniform1f(t.getUniformLocation(e,"height"),n.height),t.uniform4fv(t.getUniformLocation(e,"boundaries"),n.boundaries),t.drawArrays(t.TRIANGLE_FAN,0,4)};var v=function(t,e){t.useProgram(e);var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),t.STATIC_DRAW)},b=function(t){Object(s.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(l.a)(this,n);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).gl=void 0,t}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.store,e=document.getElementById("webgl");if(null!==e){e.width=t.getState().width,e.height=t.getState().height;var n=e.getContext("webgl",{preserveDrawingBuffer:!0});n||(n=e.getContext("experimental-webgl",{preserveDrawingBuffer:!0})),n||alert("Your browser does not support WebGL.");var o=m(n,"\nprecision highp float;\nattribute vec2 vPosition;\nvoid main(void)\n{\n\tgl_Position = vec4(vPosition, 0.0, 1.0);\n}\n","\nprecision highp int;\nprecision highp float;\n\nconst int MAX_ITER = 65535;\nconst int MAX_SAMPLING_RATE = 4096;\nuniform float iterations;\nuniform int samplingRate;\nuniform float width;\nuniform float height;\nuniform vec4 boundaries;\nuniform float radius;\nuniform int mode;\nuniform int smooth;\nuniform int interpolation;\n\nvarying float totalIterations;\n\nvec2 complexMultiplication(vec2 z1, vec2 z2)\n{\n\treturn vec2(z1.x * z2.x - z1.y * z2.y, z1.x * z2.y + z1.y * z2.x);\n}\n\n// https://github.com/hughsk/glsl-hsv2rgb/blob/master/index.glsl\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat mandelbrot(vec2 c)\n{\n\tvec2 z = vec2(0, 0);\n\tfloat n = 0.0;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (length(z) > radius) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\t\tz = complexMultiplication(z, z) + c;\n\t\tn++;\n\t}\n\treturn float(n);\n}\n\nfloat optimizedMandelbrot(vec2 c)\n{\n\tfloat n = 0.0;\n\tfloat x2 = 0.0;\n\tfloat y2 = 0.0;\n\tfloat x = 0.0;\n\tfloat y = 0.0;\n\tfloat bound = radius * radius;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (x2 + y2 > bound) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\n\t\ty = 2.0 * x * y + c.y;\n\t\tx = x2 - y2 + c.x;\n\t\tx2 = x * x;\n\t\ty2 = y * y;\n\n\t\tn++;\n\t}\n\n\treturn float(n);\n}\n\nfloat smoothMandelbrot(vec2 c)\n{\n\tfloat n = 0.0;\n\tfloat x2 = 0.0;\n\tfloat y2 = 0.0;\n\tfloat x = 0.0;\n\tfloat y = 0.0;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (x * x + y * y > pow(2.0, 8.0)) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\n\t\ty = 2.0 * x * y + c.y;\n\t\tx = x2 - y2 + c.x;\n\t\tx2 = x * x;\n\t\ty2 = y * y;\n\n\t\tn++;\n\t}\n\n\tif (n < iterations) {\n\t\treturn float(n) + 1.0 - log((log(x * x + y * y) / 2.0) / log(2.0)) / log(2.0);\n\t}\n\n\treturn float(n);\n}\n\nfloat sampling (float x, float y) {\n\tvec2 c = vec2(boundaries.x + x * (boundaries.y - boundaries.x) / (width), boundaries.z + y * (boundaries.w - boundaries.z) / (height));\n\n\tif (smooth == 1) {\n\t\treturn smoothMandelbrot(c);\n\t}\n\treturn optimizedMandelbrot(c);\n}\n\nfloat superSampling(float x, float y) {\n\tfloat change = 1.0 / (float(samplingRate) + 1.0);\n\tfloat m = 0.0;\n\tfor (int i = 1; i < MAX_SAMPLING_RATE + 1; i++) {\n\t\tif (i > samplingRate) {\n\t\t\tbreak;\n\t\t}\n\t\tfor (int j = 1; j < MAX_SAMPLING_RATE + 1; j++) {\n\t\t\tif (j > samplingRate) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tm = m + sampling(x + float(i) * change, y + float(j) * change);\n\t\t}\n\t}\n\treturn m / float(samplingRate * samplingRate);\n}\n\nvec3 bwRender(float m) {\n\tint color = m < iterations ? 1 : 0;\n\treturn vec3(color, color, color);\n}\n\nvec3 greyRender(float m) {\n\tfloat color = 1.0 - float(m) / float(iterations);\n\treturn vec3(color, color, color);\n}\n\nvec3 colorRender(float m) {\n\tfloat hue = m / iterations;\n\tfloat saturation = 1.0;\n\tfloat value = m < iterations ? 1.0 : 0.0;\n\treturn hsv2rgb(vec3(hue, saturation, value));\n}\n\nvoid main(void)\n{\n\n\tfloat x = gl_FragCoord.x - 0.5;\n\tfloat y = gl_FragCoord.y - 0.5;\n\n\tfloat m = superSampling(x, y);\n\n\tif (interpolation == 1){\n\t\tm = float(int(m));\n\t}\n\n\tvec3 color1;\n\tvec3 color2;\n\n\tif (mode == 0) {\n\t\tcolor1 = colorRender(m);\n\t\tcolor2 = colorRender(m + 1.0);\n\t}\n\n\tif (mode == 1) {\n\t\tcolor1 = greyRender(m);\n\t\tcolor2 = greyRender(m + 1.0);\n\t}\n\n\tif (mode == 2) {\n\t\tcolor1 = bwRender(m);\n\t\tcolor2 = bwRender(m + 1.0);\n\t}\n\n\tvec3 color = color1;\n\tif (interpolation == 1){\n\t\tcolor = mix(color1, color2, m); \n\t}\n\n\tgl_FragColor = vec4(color, 1.0);\n}\n");if(null!==o){v(n,o),t.listen((function(){n.useProgram(o),h(n,o,t.getState())})),window.addEventListener("resize",(function(){e.width=window.innerWidth,e.height=window.innerHeight,n.viewport(0,0,e.width,e.height),t.updateState(function(t){var e=window.innerWidth-t.width,n=window.innerHeight-t.height;return{width:window.innerWidth,height:window.innerHeight,boundaries:[t.boundaries[0]-e/2*d(t)/t.width,t.boundaries[1]+e/2*d(t)/t.width,t.boundaries[2]-n/2*f(t)/t.height,t.boundaries[3]+n/2*f(t)/t.height]}}(t.getState()))})),e.onwheel=function(n){t.updateState(function(t,e,n){if(e.preventDefault(),e.clientX>n.offsetLeft&&e.clientX<n.offsetLeft+t.width&&e.clientY>n.offsetTop&&e.clientY<n.offsetTop+t.height)return p(t,e.clientX-n.offsetLeft,e.clientY-n.offsetTop,e.deltaY)}(t.getState(),n,e))};var a=function(){var t={mode:1,previousPosition:[0,0]};return{startDrag:function(e){t.mode=0,t.previousPosition=[e.clientX,e.clientY]},endDrag:function(e){t.mode=1,t.previousPosition=[e.clientX,e.clientY]},move:function(e,n){if(0===t.mode){var o=[n.clientX,n.clientY],a=(t.previousPosition[0]-o[0])*d(e)/e.width,i=(t.previousPosition[1]-o[1])*f(e)/e.height;return t.previousPosition=o,{boundaries:[e.boundaries[0]+a,e.boundaries[1]+a,e.boundaries[2]-i,e.boundaries[3]-i]}}},isDragging:function(){return 0===t.mode}}}();e.onmousedown=function(t){a.startDrag(t)},e.onmouseup=function(t){a.endDrag(t)},e.onmousemove=function(e){a.isDragging()&&t.updateState(a.move(t.getState(),e))},this.animateIteration()}}}},{key:"animateZoom",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.props.store;n<50&&(o.updateState(g(o.getState(),e)),requestAnimationFrame((function(){return t.animateZoom(e,n+1)})))}},{key:"animateIteration",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=this.props.store,o=n.getState(),a=o.iterations;a<e&&(n.updateState({iterations:a+1}),requestAnimationFrame((function(){return t.animateIteration(e)})))}},{key:"animateRadius",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=this.props.store,o=n.getState(),a=o.radius;a<e&&(n.updateState({radius:a+.01}),requestAnimationFrame((function(){return t.animateRadius(e)})))}},{key:"downloadImage",value:function(){var t=this.props.store.getState(),e=t.iterations,n=t.samplingRate,o=t.radius,a=t.boundaries;!function(t,e){var n=t.toDataURL("image/png").replace("image/png","image/octet-stream"),o=document.createElement("a");o.setAttribute("download",e),o.setAttribute("href",n),o.click()}(document.getElementById("webgl"),"mandelbrot_"+e+"_"+n+"_"+o+"_"+a.reduce((function(t,e,n){return t+e.toString()+(n+1!==a.length?"_":"")}),"")+".png")}},{key:"render",value:function(){return a.a.createElement("canvas",{id:"webgl"})}}]),n}(a.a.Component),w=n(72),y=n(73),E=n(11),x=function(t){Object(s.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(l.a)(this,n);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).state={isOpen:!1},t}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;document.body.onkeyup=function(e){32===e.keyCode&&t.setState({isOpen:!t.state.isOpen})}}},{key:"render",value:function(){var t=this,e=this.state.isOpen,n=this.props,o=n.store,i=n.iterations,r=n.samplingRate,l=n.renderer,c=n.radius,u=n.activeMode,s=n.modes,m=n.smooth,d=n.interpolation,f=n.boundaries;return a.a.createElement(E.Drawer,{size:230,isOpen:e,onClose:function(){return t.setState({isOpen:!1})},hasBackdrop:!1,className:"bp3-dark"},a.a.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",padding:20}},a.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start"}},a.a.createElement("strong",null,"Shader:"),a.a.createElement("div",{className:"bp3-select bp3-fill",style:{marginTop:5,marginBottom:15}},a.a.createElement("select",null,a.a.createElement("option",null,"Mandelbrot"))),a.a.createElement("strong",null,"Boundaries:"),a.a.createElement("div",{style:{marginTop:5,width:"100%",display:"flex",flexWrap:"wrap",flexDirection:"row",justifyContent:"space-between"}},f.map((function(t,e){return a.a.createElement(E.Label,{style:{flexBasis:"45%"},key:e},a.a.createElement(E.NumericInput,{fill:!0,className:"bp3-dark",minorStepSize:.01,stepSize:.01,majorStepSize:.01,value:parseFloat(t.toPrecision(3)),onValueChange:function(t){var n=Object(y.a)(f);n[e]=t,o.updateState({boundaries:n})}}))}))),a.a.createElement(E.Label,null,a.a.createElement("strong",null,"Iterations:"),a.a.createElement(E.NumericInput,{className:"bp3-dark",fill:!0,value:i,onValueChange:function(t){o.updateState({iterations:t})}})),a.a.createElement(E.Label,null,a.a.createElement("strong",null,"Radius:"),a.a.createElement(E.NumericInput,{disabled:m,className:"bp3-dark",fill:!0,minorStepSize:.01,stepSize:.01,majorStepSize:.01,value:parseFloat(c.toPrecision(3)),onValueChange:function(t){o.updateState({radius:t})}})),a.a.createElement(E.Label,null,a.a.createElement("strong",null,"Sampling Rate: "),a.a.createElement("span",{className:"bp3-text-muted"},"(NxN)"),a.a.createElement(E.NumericInput,{className:"bp3-dark",fill:!0,value:r,onValueChange:function(t){o.updateState({samplingRate:t})}})),a.a.createElement("strong",null,"Mode:"),a.a.createElement("div",{className:"bp3-select bp3-fill",style:{marginTop:5,marginBottom:15}},a.a.createElement("select",{onChange:function(t){o.updateState({mode:t.currentTarget.value})},value:u},s.map((function(t,e){return a.a.createElement("option",{value:e,key:t},t)})))),a.a.createElement("strong",null,"Extra Options:"),a.a.createElement("div",{className:"bp3-fill",style:{marginTop:5,marginBottom:5}},a.a.createElement(E.Checkbox,{checked:m,onChange:function(){o.updateState({smooth:!m})}},"Smooth"),a.a.createElement(E.Checkbox,{checked:d,onChange:function(){o.updateState({interpolation:!d})}},"Interpolation")),a.a.createElement("strong",null,"Animations:"),a.a.createElement("div",{style:{marginTop:5,width:"100%"}},a.a.createElement(E.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){var t=i;o.updateState({iterations:0}),l.current.animateIteration(t)}},"Animate Iteration"),a.a.createElement(E.Button,{style:{marginBottom:15},icon:"function",fill:!0,disabled:m,onClick:function(){o.updateState({radius:0}),l.current.animateRadius()}},"Animate Radius"),a.a.createElement(E.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){l.current.animateZoom(-1)}},"Animate Zoom In"),a.a.createElement(E.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){l.current.animateZoom(1)}},"Animate Zoom Out")),a.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",padding:5,marginBottom:15}},a.a.createElement(E.Button,{icon:"zoom-in",large:!0,onClick:function(){o.updateState(g(o.getState(),-1))}}),a.a.createElement(E.Button,{icon:"zoom-out",large:!0,onClick:function(){o.updateState(g(o.getState(),1))}}))),a.a.createElement(E.Button,{icon:"download",fill:!0,onClick:function(){l.current.downloadImage()}},"Download Image")))}}]),n}(a.a.Component),S=function(t){var e=t.store,n=Object(o.useState)(e.getState()),i=Object(w.a)(n,2),r=i[0],l=i[1];return Object(o.useEffect)((function(){e.listen((function(){l(e.getState())}))})),a.a.createElement(x,Object.assign({},t,{store:e,iterations:r.iterations,samplingRate:r.samplingRate,activeMode:r.mode,modes:r.modes,smooth:r.smooth,interpolation:r.interpolation,boundaries:r.boundaries,radius:r.radius}))};n(156),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=n(71),A=n(49);var k=function(t){var e=window.innerWidth,n=400/600*e;n>window.innerHeight&&(e=1.5*window.innerHeight,n=window.innerHeight);var o=[window.innerWidth-e,window.innerHeight-n],a=Object(A.a)({iterations:0,samplingRate:1,radius:2,boundaries:[-2-o[0]/2*(3/e),1+o[0]/2*(3/e),-1-o[1]/2*(2/n),1+o[1]/2*(2/n)],width:window.innerWidth,height:window.innerHeight,mode:0,modes:["Color","Grey","Black & White"],smooth:!0,interpolation:!0},t),i=[];function r(){var t,e=Object(R.a)(i);try{for(e.s();!(t=e.n()).done;){(0,t.value)(a)}}catch(n){e.e(n)}finally{e.f()}}return{getState:function(){return a},updateState:function(t){t&&(a=Object(A.a)({},a,{},t),r())},listen:function(t){i.push(t)},fire:r}}({}),I=function(){var t=Object(o.useRef)(null);return a.a.createElement(a.a.Fragment,null,a.a.createElement(b,{store:k,ref:t}),a.a.createElement(S,{store:k,renderer:t}))};r.a.render(a.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[124,1,2]]]);
//# sourceMappingURL=main.7e961e3d.chunk.js.map