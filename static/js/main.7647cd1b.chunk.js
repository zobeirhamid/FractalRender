(this.webpackJsonpfractalrender=this.webpackJsonpfractalrender||[]).push([[0],{122:function(t,n,e){t.exports=e(155)},154:function(t,n,e){},155:function(t,n,e){"use strict";e.r(n);var o=e(0),a=e.n(o),i=e(11),r=e.n(i),l=e(37),c=e(38),u=e(39),s=e(40);var m=function(t,n,e){var o=r(t,t.VERTEX_SHADER,n),a=r(t,t.FRAGMENT_SHADER,e),i=t.createProgram();return null!==i&&null!==o&&null!==a?(t.attachShader(i,o),t.attachShader(i,a),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?(t.validateProgram(i),t.getProgramParameter(i,t.VALIDATE_STATUS)?i:(console.error("Error validating the program: "+t.getProgramInfoLog(i)),null)):(console.error("Error linking the program: "+t.getProgramInfoLog(i)),null)):null;function r(t,n,e){var o=t.createShader(n);return null!==o?(t.shaderSource(o,e),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(console.error("Error compiling the shader: "+t.getShaderInfoLog(o)),t.deleteShader(o),null)):null}};function f(t){return Math.abs(t.boundaries[0]-t.boundaries[1])}function d(t){return Math.abs(t.boundaries[2]-t.boundaries[3])}function g(t,n){return h(t,window.innerWidth/2,window.innerHeight/2,n)}function h(t,n,e,o){var a=o<0?.05:-.05,i=n/t.width,r=e/t.height;return{boundaries:[t.boundaries[0]+i*f(t)*a,t.boundaries[1]-(1-i)*f(t)*a,t.boundaries[2]+(1-r)*d(t)*a,t.boundaries[3]-r*d(t)*a]}}var p=function(t,n,e){t.vertexAttribPointer(0,3,t.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),t.enableVertexAttribArray(0),t.uniform1f(t.getUniformLocation(n,"iterations"),e.iterations),t.uniform1f(t.getUniformLocation(n,"radius"),e.radius),t.uniform1i(t.getUniformLocation(n,"mode"),e.mode),t.uniform1i(t.getUniformLocation(n,"smooth"),e.smooth),t.uniform1i(t.getUniformLocation(n,"interpolation"),e.interpolation),t.uniform1i(t.getUniformLocation(n,"samplingRate"),e.samplingRate),t.uniform1f(t.getUniformLocation(n,"width"),e.width),t.uniform1f(t.getUniformLocation(n,"height"),e.height),t.uniform4fv(t.getUniformLocation(n,"boundaries"),e.boundaries),t.drawArrays(t.TRIANGLE_FAN,0,4)};var v=function(t,n){t.useProgram(n);var e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),t.STATIC_DRAW)},b=function(t){Object(s.a)(e,t);var n=Object(u.a)(e);function e(){var t;Object(l.a)(this,e);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(t=n.call.apply(n,[this].concat(a))).gl=void 0,t}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this.props.store,n=document.getElementById("webgl");if(null!==n){n.width=t.getState().width,n.height=t.getState().height;var e=n.getContext("webgl");e||(e=n.getContext("experimental-webgl")),e||alert("Your browser does not support WebGL.");var o=m(e,"\nprecision mediump float;\nattribute vec2 vPosition;\nvoid main(void)\n{\n\tgl_Position = vec4(vPosition, 0.0, 1.0);\n}\n","\nprecision highp int;\nprecision highp float;\n\nconst int MAX_ITER = 65535;\nconst int MAX_SAMPLING_RATE = 4096;\nuniform float iterations;\nuniform int samplingRate;\nuniform float width;\nuniform float height;\nuniform vec4 boundaries;\nuniform float radius;\nuniform int mode;\nuniform int smooth;\nuniform int interpolation;\n\nvarying float totalIterations;\n\nvec2 complexMultiplication(vec2 z1, vec2 z2)\n{\n\treturn vec2(z1.x * z2.x - z1.y * z2.y, z1.x * z2.y + z1.y * z2.x);\n}\n\n// https://github.com/hughsk/glsl-hsv2rgb/blob/master/index.glsl\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat mandelbrot(vec2 c)\n{\n\tvec2 z = vec2(0, 0);\n\tfloat n = 0.0;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (length(z) > radius) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\t\tz = complexMultiplication(z, z) + c;\n\t\tn++;\n\t}\n\treturn float(n);\n}\n\nfloat optimizedMandelbrot(vec2 c)\n{\n\tfloat n = 0.0;\n\tfloat x2 = 0.0;\n\tfloat y2 = 0.0;\n\tfloat x = 0.0;\n\tfloat y = 0.0;\n\tfloat bound = radius * radius;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (x2 + y2 > bound) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\n\t\ty = 2.0 * x * y + c.y;\n\t\tx = x2 - y2 + c.x;\n\t\tx2 = x * x;\n\t\ty2 = y * y;\n\n\t\tn++;\n\t}\n\n\treturn float(n);\n}\n\nfloat smoothMandelbrot(vec2 c)\n{\n\tfloat n = 0.0;\n\tfloat x2 = 0.0;\n\tfloat y2 = 0.0;\n\tfloat x = 0.0;\n\tfloat y = 0.0;\n\tfor (int i = 0; i < MAX_ITER; i++) {\n\t\tif (x * x + y * y > pow(2.0, 8.0)) {\n\t\t\tbreak;\n\t\t}\n\t\tif (n > iterations) {\n\t\t\tbreak;\n\t\t}\n\n\t\ty = 2.0 * x * y + c.y;\n\t\tx = x2 - y2 + c.x;\n\t\tx2 = x * x;\n\t\ty2 = y * y;\n\n\t\tn++;\n\t}\n\n\tif (n < iterations) {\n\t\treturn float(n) + 1.0 - log((log(x * x + y * y) / 2.0) / log(2.0)) / log(2.0);\n\t}\n\n\treturn float(n);\n}\n\nfloat sampling (float x, float y) {\n\tvec2 c = vec2(boundaries.x + x * (boundaries.y - boundaries.x) / (width), boundaries.z + y * (boundaries.w - boundaries.z) / (height));\n\n\tif (smooth == 1) {\n\t\treturn smoothMandelbrot(c);\n\t}\n\treturn optimizedMandelbrot(c);\n}\n\nfloat superSampling(float x, float y) {\n\tfloat change = 1.0 / (float(samplingRate) + 1.0);\n\tfloat m = float(MAX_ITER);\n\tfor (int i = 1; i < MAX_SAMPLING_RATE + 1; i++) {\n\t\tif (i > samplingRate) {\n\t\t\tbreak;\n\t\t}\n\t\tfor (int j = 1; j < MAX_SAMPLING_RATE + 1; j++) {\n\t\t\tif (j > samplingRate) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfloat tmp = sampling(x + float(i) * change, y + float(j) * change);\n\t\t\tif (tmp < m) {\n\t\t\t\tm = tmp;\n\t\t\t}\n\t\t}\n\t}\n\treturn m;\n}\n\nvec3 bwRender(float m) {\n\tint color = 1 - int(m / iterations);\n\treturn vec3(color, color, color);\n}\n\nvec3 greyRender(float m) {\n\tfloat color = 1.0 - float(m) / float(iterations);\n\treturn vec3(color, color, color);\n}\n\nvec3 colorRender(float m) {\n\tfloat hue = m / iterations;\n\tfloat saturation = 1.0;\n\tfloat value = m < iterations ? 1.0 : 0.0;\n\treturn hsv2rgb(vec3(hue, saturation, value));\n}\n\nint func_mod(int x, int y) {\n\treturn int(float(x)-float(y)*floor(float(x)/float(y)));\n}\n\nvoid main(void)\n{\n\n\tfloat x = gl_FragCoord.x - 0.5;\n\tfloat y = gl_FragCoord.y - 0.5;\n\n\tfloat m = superSampling(x, y);\n\n\tvec3 color1;\n\tvec3 color2;\n\n\tif (mode == 0) {\n\t\tcolor1 = colorRender(m);\n\t\tcolor2 = colorRender(m + 1.0);\n\t}\n\n\tif (mode == 1) {\n\t\tcolor1 = greyRender(m);\n\t\tcolor2 = greyRender(m + 1.0);\n\t}\n\n\tif (mode == 2) {\n\t\tcolor1 = bwRender(m);\n\t\tcolor2 = bwRender(m + 1.0);\n\t}\n\n\tvec3 color = color1;\n\tif (interpolation == 1){\n\t\tcolor = mix(color1, color2, m); \n\t}\n\n\tgl_FragColor = vec4(color, 1.0);\n}\n");if(null!==o){v(e,o),t.listen((function(){e.useProgram(o),p(e,o,t.getState())})),window.addEventListener("resize",(function(){n.width=window.innerWidth,n.height=window.innerHeight,e.viewport(0,0,n.width,n.height),t.updateState(function(t){var n=window.innerWidth-t.width,e=window.innerHeight-t.height;return{width:window.innerWidth,height:window.innerHeight,boundaries:[t.boundaries[0]-n/2*f(t)/t.width,t.boundaries[1]+n/2*f(t)/t.width,t.boundaries[2]-e/2*d(t)/t.height,t.boundaries[3]+e/2*d(t)/t.height]}}(t.getState()))})),n.onwheel=function(e){t.updateState(function(t,n,e){if(n.preventDefault(),n.clientX>e.offsetLeft&&n.clientX<e.offsetLeft+t.width&&n.clientY>e.offsetTop&&n.clientY<e.offsetTop+t.height)return h(t,n.clientX-e.offsetLeft,n.clientY-e.offsetTop,n.deltaY)}(t.getState(),e,n))};var a=function(){var t={mode:1,previousPosition:[0,0]};return{startDrag:function(n){t.mode=0,t.previousPosition=[n.clientX,n.clientY]},endDrag:function(n){t.mode=1,t.previousPosition=[n.clientX,n.clientY]},move:function(n,e){if(0===t.mode){var o=[e.clientX,e.clientY],a=(t.previousPosition[0]-o[0])*f(n)/n.width,i=(t.previousPosition[1]-o[1])*d(n)/n.height;return t.previousPosition=o,{boundaries:[n.boundaries[0]+a,n.boundaries[1]+a,n.boundaries[2]-i,n.boundaries[3]-i]}}},isDragging:function(){return 0===t.mode}}}();n.onmousedown=function(t){a.startDrag(t)},n.onmouseup=function(t){a.endDrag(t)},n.onmousemove=function(n){a.isDragging()&&t.updateState(a.move(t.getState(),n))},this.animateIteration()}}}},{key:"animateZoom",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.props.store;e<50&&(o.updateState(g(o.getState(),n)),requestAnimationFrame((function(){return t.animateZoom(n,e+1)})))}},{key:"animateIteration",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=this.props.store,o=e.getState(),a=o.iterations;a<n&&(e.updateState({iterations:a+1}),requestAnimationFrame((function(){return t.animateIteration(n)})))}},{key:"animateRadius",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=this.props.store,o=e.getState(),a=o.radius;a<n&&(e.updateState({radius:a+.01}),requestAnimationFrame((function(){return t.animateRadius(n)})))}},{key:"render",value:function(){return a.a.createElement("canvas",{id:"webgl"})}}]),e}(a.a.Component),y=e(71),w=e(13),x=function(t){Object(s.a)(e,t);var n=Object(u.a)(e);function e(){var t;Object(l.a)(this,e);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(t=n.call.apply(n,[this].concat(a))).state={isOpen:!1},t}return Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;document.body.onkeyup=function(n){32===n.keyCode&&t.setState({isOpen:!t.state.isOpen})}}},{key:"render",value:function(){var t=this,n=this.state.isOpen,e=this.props,o=e.store,i=e.iterations,r=e.samplingRate,l=e.renderer,c=e.radius,u=e.activeMode,s=e.modes,m=e.smooth,f=e.interpolation;return a.a.createElement(w.Drawer,{size:220,isOpen:n,onClose:function(){return t.setState({isOpen:!1})},hasBackdrop:!1,className:"bp3-dark"},a.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",padding:20}},a.a.createElement("strong",null,"Shader:"),a.a.createElement("div",{className:"bp3-select bp3-fill",style:{marginTop:5,marginBottom:15}},a.a.createElement("select",null,a.a.createElement("option",null,"Mandelbrot"))),a.a.createElement(w.Label,null,a.a.createElement("strong",null,"Iterations:"),a.a.createElement(w.NumericInput,{className:"bp3-dark",fill:!0,min:1,max:1e4,value:i,onValueChange:function(t){o.updateState({iterations:t})}})),a.a.createElement(w.Label,null,a.a.createElement("strong",null,"Radius:"),a.a.createElement(w.NumericInput,{disabled:m,className:"bp3-dark",fill:!0,min:0,max:5,stepSize:.1,value:c,onValueChange:function(t){o.updateState({radius:t})}})),a.a.createElement(w.Label,null,a.a.createElement("strong",null,"Sampling Rate: "),a.a.createElement("span",{className:"bp3-text-muted"},"(NxN)"),a.a.createElement(w.NumericInput,{className:"bp3-dark",fill:!0,min:1,max:64,value:r,onValueChange:function(t){o.updateState({samplingRate:t})}})),a.a.createElement("strong",null,"Mode:"),a.a.createElement("div",{className:"bp3-select bp3-fill",style:{marginTop:5,marginBottom:15}},a.a.createElement("select",{onChange:function(t){o.updateState({mode:t.currentTarget.value})},value:u},s.map((function(t,n){return a.a.createElement("option",{value:n,key:t},t)})))),a.a.createElement("strong",null,"Extra Options:"),a.a.createElement("div",{className:"bp3-fill",style:{marginTop:5,marginBottom:5}},a.a.createElement(w.Checkbox,{checked:m,onChange:function(){o.updateState({smooth:!m})}},"Smooth"),a.a.createElement(w.Checkbox,{checked:f,onChange:function(){o.updateState({interpolation:!f})}},"Interpolation")),a.a.createElement("strong",null,"Animations:"),a.a.createElement("div",{style:{marginTop:5,width:"100%"}},a.a.createElement(w.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){var t=i;o.updateState({iterations:0}),l.current.animateIteration(t)}},"Animate Iteration"),a.a.createElement(w.Button,{style:{marginBottom:15},icon:"function",fill:!0,disabled:m,onClick:function(){o.updateState({radius:0}),l.current.animateRadius()}},"Animate Radius"),a.a.createElement(w.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){l.current.animateZoom(-1)}},"Animate Zoom In"),a.a.createElement(w.Button,{style:{marginBottom:15},icon:"function",fill:!0,onClick:function(){l.current.animateZoom(1)}},"Animate Zoom Out")),a.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",padding:5,marginBottom:15}},a.a.createElement(w.Button,{icon:"zoom-in",large:!0,onClick:function(){o.updateState(g(o.getState(),-1))}}),a.a.createElement(w.Button,{icon:"zoom-out",large:!0,onClick:function(){o.updateState(g(o.getState(),1))}}))))}}]),e}(a.a.Component),E=function(t){var n=t.store,e=Object(o.useState)(n.getState()),i=Object(y.a)(e,2),r=i[0],l=i[1];return Object(o.useEffect)((function(){n.listen((function(){l(n.getState())}))})),a.a.createElement(x,Object.assign({},t,{store:n,iterations:r.iterations,samplingRate:r.samplingRate,activeMode:r.mode,modes:r.modes,smooth:r.smooth,interpolation:r.interpolation,radius:r.radius}))};e(154),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=e(70),R=e(48);var A=function(t){var n=window.innerWidth,e=400/600*n;e>window.innerHeight&&(n=1.5*window.innerHeight,e=window.innerHeight);var o=[window.innerWidth-n,window.innerHeight-e],a=Object(R.a)({iterations:0,samplingRate:1,radius:2,boundaries:[-2-o[0]/2*(3/n),1+o[0]/2*(3/n),-1-o[1]/2*(2/e),1+o[1]/2*(2/e)],width:window.innerWidth,height:window.innerHeight,mode:0,modes:["Color","Grey","Black & White"],smooth:!0,interpolation:!0},t),i=[];function r(){var t,n=Object(S.a)(i);try{for(n.s();!(t=n.n()).done;){(0,t.value)(a)}}catch(e){n.e(e)}finally{n.f()}}return{getState:function(){return a},updateState:function(t){t&&(a=Object(R.a)({},a,{},t),r())},listen:function(t){i.push(t)},fire:r}}({}),k=function(){var t=Object(o.useRef)(null);return a.a.createElement(a.a.Fragment,null,a.a.createElement(b,{store:A,ref:t}),a.a.createElement(E,{store:A,renderer:t}))};r.a.render(a.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[122,1,2]]]);
//# sourceMappingURL=main.7647cd1b.chunk.js.map